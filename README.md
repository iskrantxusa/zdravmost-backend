# Zdravmost Backend API

Телемедицинская платформа для проведения онлайн консультаций врачей с пациентами.

## Технологический стек

- **Backend**: NestJS (Node.js/TypeScript)
- **Database**: PostgreSQL + Redis
- **Authentication**: JWT
- **Payments**: Stripe
- **Video Calls**: Agora.io / Twilio
- **File Storage**: AWS S3
- **Architecture**: Модульный монолит с перспективой на микросервисы

## Структура проекта

```
zdravmost-backend/
├── apps/
│   └── api/                 # Основное API приложение
│       ├── src/
│       │   ├── modules/     # Модули бизнес-логики
│       │   │   ├── auth/    # Аутентификация
│       │   │   ├── users/   # Управление пользователями
│       │   │   ├── doctors/ # Врачи
│       │   │   ├── patients/# Пациенты
│       │   │   ├── appointments/ # Записи на прием
│       │   │   ├── consultations/ # Видеоконсультации
│       │   │   ├── medical-records/ # Медкарты
│       │   │   ├── payments/ # Оплата
│       │   │   └── notifications/ # Уведомления
│       │   ├── common/      # Общие утилиты
│       │   ├── config/      # Конфигурация
│       │   └── main.ts      # Точка входа
│       └── test/            # E2E тесты
├── libs/                    # Переиспользуемые библиотеки
│   ├── database/            # Конфигурация БД
│   ├── redis/               # Redis модуль
│   ├── email/               # Email сервис
│   └── file-storage/        # Загрузка файлов
├── dist/                    # Скомпилированные файлы
├── .env.example             # Пример переменных окружения
├── package.json
├── nest-cli.json
└── README.md
```

## Установка и запуск

### Предварительные требования

- Node.js >= 18
- PostgreSQL >= 13
- Redis >= 6
- npm или yarn

### Установка зависимостей

```bash
npm install
```

### Настройка окружения

1. Скопируйте файл с переменными окружения:
```bash
cp .env.example .env
```

2. Отредактируйте `.env` файл, указав ваши настройки:
   - Параметры подключения к PostgreSQL
   - Параметры подключения к Redis
   - JWT секретные ключи
   - API ключи для внешних сервисов (Stripe, Agora, AWS и т.д.)

### Запуск в режиме разработки

```bash
# Запуск API в режиме разработки с автоперезагрузкой
npm run start:dev

# Запуск в debug режиме
npm run start:debug
```

### Сборка для продакшена

```bash
# Сборка проекта
npm run build

# Запуск в продакшене
npm run start:prod
```

## Скрипты разработки

```bash
# Линтинг кода
npm run lint

# Форматирование кода
npm run format

# Запуск тестов
npm run test

# Запуск тестов с покрытием
npm run test:cov

# E2E тесты
npm run test:e2e
```

## API Документация

После запуска сервера документация Swagger будет доступна по адресу:
```
http://localhost:3000/api
```

## Основные модули

### 1. Аутентификация (`auth`)
- Регистрация и вход пользователей
- JWT токены
- Роли и права доступа

### 2. Пользователи (`users`)
- Управление профилями пациентов и врачей
- Верификация документов врачей

### 3. Записи на прием (`appointments`)
- Создание и управление записями
- Расписание врачей
- Уведомления о записях

### 4. Видеоконсультации (`consultations`)
- Интеграция с Agora.io/Twilio
- Управление комнатами для видеозвонков
- История консультаций

### 5. Медицинские карты (`medical-records`)
- Хранение истории консультаций
- Рецепты и заключения
- Загрузка медицинских документов

### 6. Платежи (`payments`)
- Интеграция со Stripe
- Обработка платежей за консультации
- История транзакций

### 7. Уведомления (`notifications`)
- Push уведомления
- Email рассылка
- SMS уведомления

## Безопасность

- Все медицинские данные шифруются
- Соблюдение стандартов HIPAA/GDPR
- Rate limiting для API
- Валидация входящих данных
- Логирование всех действий

## Мониторинг и логирование

- Структурированное логирование
- Метрики производительности
- Мониторинг здоровья приложения
- Error tracking

## Развертывание

Проект готов к развертыванию с использованием:
- Docker контейнеры
- Kubernetes
- AWS/Google Cloud
- CI/CD pipeline

## Вклад в проект

1. Создайте feature branch от main
2. Внесите изменения
3. Убедитесь, что тесты проходят
4. Создайте Pull Request

## Лицензия

Все права защищены © 2024 Zdravmost
